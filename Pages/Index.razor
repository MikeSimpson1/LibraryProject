@page "/"
@inject BookService bookService
@inject UserManager<AppUser> userManager
@inject NavigationManager navManager
<PageTitle>Index</PageTitle>
<style>
    .card {
        /* Add shadows to create the "card" effect */
        box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
        transition: 0.3s;
        width: 200px;
        padding: 5px 5px;
        cursor:pointer;
    }

        /* On mouse-over, add a deeper shadow */
        .card:hover {
            box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
        }

    /* Add some padding inside the card container */
    .container {
        padding: 0px 0px;
    }

    .img {
        width: 128px;
        height: 185px;
    }
    .center {
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 50%;
}.titleText{
    text-align:center;
}
</style>
<h1>Hello, world!</h1>

Welcome to your new app.
@if (currentlyReading == null || currentlyReading.Count <= 0)
{
}
else
{
    <p><em>Currently Reading</em></p>
    <div class="row">
        @if (currentlyReading.Count > 0)
        {
            foreach (BookData b in currentlyReading)
            {
                <div class="card" @onclick="() => Redirect(b.Id)">
                    <img src="@b.ImageLink" alt="Cover" style="width:128px;height:185px" class="center">
                    <div class="container">
                        <h4 class="titleText"><b>@b.Title</b></h4>
                        <p class="titleText">@b.Author</p>
                        <p class="titleText">@b.PublishedDate</p>
                    </div>
                </div>
            }
        }
    </div>
}
@if (wantToRead == null || wantToRead.Count <= 0)
{
}
else
{
    <p><em>Want to Read</em></p>
    <div class="row">
        @if (wantToRead.Count > 0)
        {
            foreach (BookData b in wantToRead)
            {
                <div class="card" @onclick="() => Redirect(b.Id)">
                    <img src="@b.ImageLink" alt="Cover" style="width:128px;height:185px" class="center">
                    <div class="container">
                        <h4 class="titleText"><b>@b.Title</b></h4>
                        <p class="titleText">@b.Author</p>
                        <p class="titleText">@b.PublishedDate</p>
                    </div>
                </div>
            }
        }
    </div>
}
@if (read == null || read.Count <= 0)
{
}
else
{
    <p><em>Read</em></p>
    <div class="row">
        @if (read.Count > 0)
        {
            foreach (BookData b in read)
            {
                <div class="card" @onclick="() => Redirect(b.Id)">
                    <img src="@b.ImageLink" alt="Cover" style="width:128px;height:185px" class="center">
                    <div class="container">
                        <h4 class="titleText"><b>@b.Title</b></h4>
                        <p class="titleText">@b.Author</p>
                        <p class="titleText">@b.PublishedDate</p>
                    </div>
                </div>
            }
        }
    </div>
}

@code {
    private List<BookData>? currentlyReading;
    private List<BookData>? wantToRead;
    private List<BookData>? read;
    protected override async Task OnInitializedAsync()
    {
        if (signInManager.IsSignedIn(_httpContextAccessor.HttpContext.User))
        {
            var user = await userManager.FindByEmailAsync(_httpContextAccessor.HttpContext.User.Identity.Name);
            currentlyReading = bookService.getUsersBooks(user.BooksCurrentlyReading);
            wantToRead = bookService.getUsersBooks(user.BooksWantToRead);
            read = bookService.getUsersBooks(user.BooksRead);
        }
    }
    private void Redirect(int? id)
    {
        navManager.NavigateTo("/BookInfo/" + id);
    }
}